<!DOCTYPE html>
<html lang="fr" data-theme="dark">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Documentation</title>
        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        <script src="./docs/index.js"></script>
        <style>
            /* =======================
            THEMES
            ======================= */
            :root {
                --bg: #29302b;
                --bg-light: #222222;
                --panel: #222222;
                --border: #86858f;
                --text: #f5f5f5;
                --muted: #aba9bb;
                --accent: #c49d00;
            }

            html[data-theme="light"] {
                --bg: #ffffff;
                --bg-light: #f6f4f1;
                --panel: #f6f4f1;
                --border: #8a9a83;
                --text: #2f2e2c;
                --muted: #7a7670;
                --accent: #c46a4a;
            }

            /* =======================
            BASE
            ======================= */
            * { box-sizing: border-box; }

            body {
                margin: 0;
                font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
                background: var(--bg);
                color: var(--text);
                display: flex;
                height: 100vh;
                overflow: hidden;
                transition: background .2s, color .2s;
            }

            /* =======================
            LAYOUT
            ======================= */
            .sidebar {
                width: 320px;
                background: var(--panel);
                border-right: 1px solid var(--border);
                display: flex;
                flex-direction: column;
            }

            .header {
                padding: 16px;
                font-weight: 700;
                font-size: 18px;
                border-bottom: 1px solid var(--border);
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            /* Theme toggle */
            .theme-toggle {
                cursor: pointer;
                border: 1px solid var(--border);
                background: var(--bg-light);
                color: var(--text);
                border-radius: 999px;
                padding: 6px 12px;
                font-size: 13px;
            }

            .search { padding: 12px; }

            .search input {
                width: 100%;
                padding: 10px 12px;
                border-radius: 8px;
                border: 1px solid var(--border);
                background: var(--bg-light);
                color: var(--text);
            }

            .nav {
                overflow-y: auto;
                padding: 8px;
                flex: 1;
            }

            .project { margin-bottom: 16px; }

            .project-title {
                font-size: 12px;
                text-transform: uppercase;
                color: var(--muted);
                margin: 8px;
            }

            .doc-item {
                padding: 8px 12px;
                border-radius: 8px;
                cursor: pointer;
                font-size: 14px;
            }

            .doc-item:hover { background: color-mix(in srgb, var(--accent) 15%, transparent); }

            .doc-item.active {
                background: var(--accent);
                color: white;
                font-weight: 600;
            }

            /* =======================
            CONTENT
            ======================= */
            .content {
                flex: 1;
                overflow-y: auto;
                padding: 32px;
            }

            .content h1, .content h2, .content h3 { color: var(--text); }

            .content table {
                width: 100%;
                border-collapse: collapse;
                margin: 16px 0;
            }

            .content th, .content td {
                border: 1px solid var(--border);
                padding: 8px;
            }

            .content th { background: var(--bg-light); }

            .content code {
                background: var(--bg-light);
                padding: 2px 6px;
                border-radius: 4px;
            }

            .content pre {
                background: var(--bg-light);
                padding: 16px;
                border-radius: 8px;
                overflow-x: auto;
            }

            /* =======================
            RESPONSIVE
            ======================= */
            @media (max-width: 768px) {
                body { flex-direction: column; }

                .sidebar {
                    width: 100%;
                    height: 40%;
                }
            }
    </style>
    </head>
    <body>
        <div class="sidebar">
            <div class="header">
                ðŸ“š Documentation
                <button class="theme-toggle" id="themeToggle">ðŸŒ™</button>
            </div>
            <div class="search">
                <input type="text" placeholder="Rechercher..." id="searchInput" />
            </div>
            <div class="nav" id="nav"></div>
        </div>
        <div class="content" id="content">
            <p>Select file in menu ðŸ‘ˆ</p>
        </div>

        <script>
            /* =======================
            THEME
            ======================= */
            const root = document.documentElement;
            const toggleBtn = document.getElementById("themeToggle");

            function applyTheme(theme) {
                root.setAttribute("data-theme", theme);
                toggleBtn.textContent = theme === "dark" ? "ðŸŒ™" : "â˜€ï¸";
                localStorage.setItem("theme", theme);
            }

            const savedTheme = localStorage.getItem("theme") || "dark";
            applyTheme(savedTheme);

            toggleBtn.onclick = () => {
            const current = root.getAttribute("data-theme");
                applyTheme(current === "dark" ? "light" : "dark");
            };

            /* =======================
            DOC APP
            ======================= */
            const nav = document.getElementById("nav");
            const content = document.getElementById("content");
            const searchInput = document.getElementById("searchInput");

            let flatDocs = [];
            function buildNav(index) {
                nav.innerHTML = "";
                flatDocs = [];

                Object.entries(index).forEach(([project, docs]) => {
                    const projectDiv = document.createElement("div");
                    projectDiv.className = "project";

                    const title = document.createElement("div");
                    title.className = "project-title";
                    title.textContent = project;
                    projectDiv.appendChild(title);

                    docs.forEach(doc => {
                        flatDocs.push(doc);
                        const item = document.createElement("div");
                        item.className = "doc-item";
                        item.textContent = doc.title;
                        item.onclick = () => loadDoc(doc, item);
                        projectDiv.appendChild(item);
                    });

                    nav.appendChild(projectDiv);
                });
            }

            function loadDoc(doc, el) {
                document.querySelectorAll(".doc-item").forEach(i => i.classList.remove("active"));
                el.classList.add("active");
                content.innerHTML = marked.parse(doc.content);
            }

            searchInput.addEventListener("input", e => {
                const q = e.target.value.toLowerCase();
                nav.querySelectorAll(".doc-item").forEach(item => {
                    const doc = flatDocs.find(d => d.title === item.textContent);
                    const match = doc.title.toLowerCase().includes(q) ||
                        doc.content.toLowerCase().includes(q);
                    item.style.display = match ? "block" : "none";
                });
            });
            buildNav(window.DOC_INDEX);
        </script>
    </body>
</html>
